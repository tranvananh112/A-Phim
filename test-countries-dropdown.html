<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Countries Dropdown</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-white p-8">
    <h1 class="text-2xl font-bold mb-4">Test Countries Dropdown</h1>

    <div class="mb-4">
        <label class="block mb-2">Quốc gia:</label>
        <select id="countryFilter" class="w-64 px-3 py-2 bg-gray-800 border border-gray-700 rounded text-white">
            <option value="">Loading...</option>
        </select>
    </div>

    <div class="mt-4">
        <button onclick="testLoadMovies()" class="px-4 py-2 bg-blue-600 rounded hover:bg-blue-700">
            Test Load Movies
        </button>
    </div>

    <div id="result" class="mt-4 p-4 bg-gray-800 rounded">
        <pre id="output">Chưa có kết quả...</pre>
    </div>

    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script>
        async function loadCountries() {
            console.log('Loading countries...');
            const countries = await movieAPI.getCountries();
            console.log('Countries:', countries);

            const select = document.getElementById('countryFilter');
            select.innerHTML = '<option value="">-- Chọn quốc gia --</option>' +
                countries.map(c => `<option value="${c.slug}">${c.name}</option>`).join('');

            document.getElementById('output').textContent =
                `Loaded ${countries.length} countries:\n` +
                JSON.stringify(countries, null, 2);
        }

        async function testLoadMovies() {
            const countrySlug = document.getElementById('countryFilter').value;
            if (!countrySlug) {
                alert('Vui lòng chọn quốc gia');
                return;
            }

            document.getElementById('output').textContent = 'Loading movies...';

            try {
                const data = await movieAPI.getMoviesByCountry(countrySlug, 1);
                console.log('Movies data:', data);

                document.getElementById('output').textContent =
                    `Movies for ${countrySlug}:\n` +
                    `Status: ${data.status}\n` +
                    `Items: ${data.data?.items?.length || 0}\n\n` +
                    JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('output').textContent = 'Error: ' + error.message;
            }
        }

        // Load on page load
        loadCountries();
    </script>
</body>

</html>